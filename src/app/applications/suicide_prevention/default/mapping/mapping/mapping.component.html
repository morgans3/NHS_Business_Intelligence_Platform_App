<mat-card>
  <mat-card-content>
    <div class="file_input_div">
      <div class="file_input">
        Select Data File [xlsx] :-
        <label class="mat-raised-button mat-primary">
          <span class="mat-button-wrapper">
            Upload File
            <input id="file_input_file" (change)="incomingfile($event)" accept=".xlsx" type="file" style="display: none" multiple="false" />
          </span>
        </label>
        <div *ngIf="workbook" style="display: inline-block">&nbsp; {{ workbook.name }}</div>

        <button type="button" mat-icon-button color="warn" (click)="clearFile()" [disabled]="!file" [matTooltip]="'Clear File'">
          <i class="fas fa-backspace"></i>
        </button>
      </div>
    </div>
  </mat-card-content>
</mat-card>

<mat-card>
  <mat-card-content>
    <mat-card-title>Map</mat-card-title>

    <div #mapGraph [ngStyle]="mapHeight">
      <app-map [hidden]="!MapData && mapStyle.display !== 'block'" [MapData]="MapData" MapName="MapName" [MapZoom]="MapZoom" [MapCenter]="MapCenter" [rerender]="mapRender"></app-map>
    </div>
    <app-incidentLegend [input]="mapLegend"></app-incidentLegend>
  </mat-card-content>
</mat-card>

<mat-card>
  <mat-card-content>
    <mat-card-title> Filters </mat-card-title>
    Date Range:
    <mat-form-field appearance="fill">
      <mat-label>Enter a date range</mat-label>
      <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
        <input matStartDate formControlName="start" placeholder="Start date" />
        <input matEndDate formControlName="end" placeholder="End date" />
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>
    Contains text:
    <mat-form-field>
      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Type here to add a text filter..." />
    </mat-form-field>
  </mat-card-content>
</mat-card>

<mat-card>
  <mat-card-content>
    <mat-card-title>Selected Data</mat-card-title>
    <mat-tab-group *ngIf="workbook">
      <mat-tab *ngFor="let sheet of workbook.worksheets; let i = index" [label]="sheet.name">
        <app-worksheet [sheet]="sheet.data" [filtertext]="filtertext" [filterrange]="selectedDashboard.range"></app-worksheet>
      </mat-tab>
    </mat-tab-group>
  </mat-card-content>
</mat-card>
