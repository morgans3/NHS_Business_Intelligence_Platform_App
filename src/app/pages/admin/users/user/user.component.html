<div fxLayout="row wrap" fxLayoutGap="15px" class="pill">
  <div fxFlex.gt-md="135px" fxFlex.gt-xs="100" fxFlex="100" fxLayoutAlign="center center">
    <img mat-card-avatar [src]="user?.profile.photobase64 || '../../../../../assets/images/login.png'" />
  </div>
  <div fxFlex.gt-md="calc(100% - 155px)" fxFlex.gt-xs="100" fxFlex="100" fxLayoutAlign="start center">
    <div>
      <p><b>Name:</b> {{ user?.profile.name }} <b class="m-l-30">Username: </b> {{ user?.profile.username }}</p>
      <p>
        <b>Organisation: </b> {{ user?.profile.organisation }}
        <span *ngIf="user?.profile.linemanager" class="m-l-30"><b>Line manager: </b> {{ user?.profile.linemanager }}</span>
      </p>
    </div>
  </div>
</div>

<mat-divider style="position: relative; margin: 30px 0px"></mat-divider>
<mat-card-title>Assigned Roles</mat-card-title>
<mat-form-field>
  <mat-label>Assign a new role</mat-label>
  <input type="text" placeholder="Search by name" aria-label="Number" matInput [matAutocomplete]="roleAutoComplete" />
  <mat-autocomplete (optionSelected)="role.assign(null)" #roleAutoComplete="matAutocomplete">
    <!-- <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
            {{option}}
        </mat-option> -->
    <mat-option value="covid_19">COVID-19 Data</mat-option>
  </mat-autocomplete>
</mat-form-field>
<table mat-table [dataSource]="user.roles" class="w-100">
  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef>Role Name</th>
    <td mat-cell *matCellDef="let element">{{ element.name }}</td>
  </ng-container>

  <!-- Capabilties Column -->
  <ng-container matColumnDef="capabilities">
    <th mat-header-cell *matHeaderCellDef>Capabilities</th>
    <td mat-cell *matCellDef="let element">{{ element.capabilities.join(", ") }}</td>
  </ng-container>

  <!-- Description Column -->
  <ng-container matColumnDef="description">
    <th mat-header-cell *matHeaderCellDef>Description</th>
    <td mat-cell *matCellDef="let element">{{ element.description }}</td>
  </ng-container>

  <!-- Actions Column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let element">
      <button mat-raised-button color="primary">Revoke</button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['name', 'capabilities', 'description', 'actions']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['name', 'capabilities', 'description', 'actions']"></tr>
</table>

<mat-card-title class="m-t-30">Assigned Capabilities</mat-card-title>
<mat-form-field>
  <mat-label>Assign a new capability</mat-label>
  <input type="text" placeholder="Search by name" aria-label="Number" matInput [matAutocomplete]="roleAutoComplete" />
  <mat-autocomplete (optionSelected)="capability.assign(null)" #roleAutoComplete="matAutocomplete">
    <!-- <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
            {{option}}
        </mat-option> -->
    <mat-option value="covid_19">COVID-19 Data</mat-option>
  </mat-autocomplete>
</mat-form-field>
<table mat-table [dataSource]="user.capabilities" class="w-100">
  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef>Name</th>
    <td mat-cell *matCellDef="let element">{{ element.name }}</td>
  </ng-container>

  <!-- Description Column -->
  <ng-container matColumnDef="description">
    <th mat-header-cell *matHeaderCellDef>Description</th>
    <td mat-cell *matCellDef="let element">{{ element.description }}</td>
  </ng-container>

  <!-- Description Column -->
  <ng-container matColumnDef="approved_by">
    <th mat-header-cell *matHeaderCellDef>Approved by</th>
    <td mat-cell *matCellDef="let element">{{ element.approved_by }}</td>
  </ng-container>

  <!-- Actions Column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let element">
      <button mat-raised-button color="primary">Revoke</button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['name', 'description', 'approved_by', 'actions']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['name', 'description', 'approved_by', 'actions']"></tr>
</table>

<mat-card-title class="m-t-30">Teams</mat-card-title>
<mat-form-field>
  <mat-label>Add user to new team</mat-label>
  <input type="text" placeholder="Search by name" matInput (keyup)="team.search($event.target.value)" [matAutocomplete]="roleAutoComplete" #teamSearchInput />
  <mat-autocomplete (optionSelected)="team.assign($event)" #roleAutoComplete="matAutocomplete">
    <!-- <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
            {{option}}
        </mat-option> -->
    <mat-option value="covid_19">COVID-19 Data</mat-option>
  </mat-autocomplete>
</mat-form-field>
<table mat-table [dataSource]="user.teams" class="w-100">
  <!-- Name Column -->
  <ng-container matColumnDef="teamcode">
    <th mat-header-cell *matHeaderCellDef>Team Code</th>
    <td mat-cell *matCellDef="let element">{{ element.teamcode }}</td>
  </ng-container>

  <!-- Join date Column -->
  <ng-container matColumnDef="joindate">
    <th mat-header-cell *matHeaderCellDef>Join date</th>
    <td mat-cell *matCellDef="let element">{{ element.joindate }}</td>
  </ng-container>

  <!-- Actions Column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let element">
      <button mat-raised-button color="primary">Remove</button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['teamcode', 'joindate', 'actions']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['teamcode', 'joindate', 'actions']"></tr>
</table>
