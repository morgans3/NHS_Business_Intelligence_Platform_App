FROM node:10-slim as build
ARG TEST_SERVER_URL
ENV TEST_SERVER_URL ${TEST_SERVER_URL}
WORKDIR /home/node
COPY . /home/node/
RUN npm install
RUN npm run e2e

FROM nginx:alpine
COPY nginx.conf /etc/nginx/conf.d/default.conf
RUN rm -rf /usr/share/nginx/html/*
COPY --from=build /home/node/dist /usr/share/nginx/html
